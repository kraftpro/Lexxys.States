database
	connection
		:server				.
//		:server				test
		:database			CharityPlanner
		:user				sa
		:password			post+Office2
		:commandTimeout		10m
		:connectionTimeout	10s

		:batchAudit			1s
		:commandAudit		1s
	driver	SqlDataAdapter

statechartsCollection
	%statechart name
	%statechart(**)/state		name
	%statechart(**)/state/transition	event target

	statechart Expense
		:start	Submit	// Initial action for statechart

		- Submit
			:enter		System.Console.WriteLine("Begin submission");
			:exit		System.Console.WriteLine("End submission");
			transition	Delete			=> Removed			// The action is available globally in subchart
			transition	*				=> AdminReview		// Action on exiting from subchart

			subchart
				:start	Draft	// Initial action for subchart
				- Draft
					transition	SubmitToPca		=> *		// Exit from the subchart
						:action Obj.SendToPcaReview()
					transition	SubmitToReview	=> Review
						:action Obj.SendToReview()

				- Review
					transition	Ask				=> ReviewQuestions
						:action Obj.AskQuestion()
					transition	Approve			=> *

				- ReviewQuestions
					:enter System.Console.WriteLine("Waiting for answer");
					transition	Answer			=> Review
						:action System.Console.WriteLine("Got answer");
					transition	-				=> Review
						:condition	0 == (++Obj.Value & 1)
						:action System.Console.WriteLine("Auto answer");
		- AdminReview
			transition	Cancel			=> Canceled		// Cancel action is available after Draft
			transition	*				=> Done			// Done available in subchart 
			transition	BackToSubmit	=> Submit		//  

			subchart
				:start	PcaReview
				- PcaReview
					transition	RequestLr		=> LegalReview
					transition	Question		=> NeedMoreInfo
					transition	SubmitForPayment=> FinOpsReview
					transition	Back			=> Expense.Submit

				- LegalReview
					transition	Done			=> PcaReview	// override Done action from upper level

				- Questions
					transition	Ignore			=> PcaReview
					transition	SubmitAnswer	=> PcaReview

				- FinOpsReview
					transition	SubmitToReview	=> PcaReview
					transition	SubmitToProcess	=> *

				- AdminDraft
					transition	Submit			=> PcaReview
					transition	SubmitToPayment	=> FinOpsReview
					transition	Delete			=> Removed

				- NeedMoreInfo
					transition	ResponseToPca	=> PcaReview
					transition	Ignore			=> PcaReview

		- Done

		- Canceled
			:enter Obj.Cancel()

		- Removed
			:enter Obj.Delete()

	statechart PositionFile
		:start Group1

		- Ignored
			transition	Undo	=> Group1
		- Done

		- Group1
			transition	Ignore	=>	Ignored

			subchart
				:start	Group2

				- OnHoldWithIssues
					transition AllManualIssuesClosed	=> Group2
				- Group2
					transition	*	=> OnHoldWithIssues
						:condition	Obj.HasManualIssues

					subchart
						:start NotMatched
						- NotMatched
							transition	-						=> Matched
								:condition Obj.IsMatched
							transition	ApproveWithDifference	=> Group3.Approved

						- Matched
							transition	Approve					=> Group3.Approved
							transition	-						=> NotMatched
								:condition !Obj.IsMatched

						-NotMatched2
							transition	-						=> Group3
								:condition	Obj.IsMatched

						- Group3
							transition	*						=> NotMatched2

							subchart
								:start Approved
								- Approved
									transition	*				=> ReadyWithCleanup
										:condition Obj.HasAutomaticIssues
									transition	*				=> SecondReview
										:condition Obj.SecondReviewRequired
									transition *				=> Done
								- ReadyWithCleanup
									transition	*				=> Approved
										:condition Obj.NoIssues
								- SecondReview
									transition	*				=> ReadyWithCleanup
										:condition Obj.HasAutomaticIssues
									transition ReviewCompleted	=> Done
